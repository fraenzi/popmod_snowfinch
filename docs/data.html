<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Data | A predictive population model for a high-elevation specialist bird species</title>
  <meta name="description" content="We here present what we know about population dynamics of Snowfinches." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Data | A predictive population model for a high-elevation specialist bird species" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/sf.jpg" />
  <meta property="og:description" content="We here present what we know about population dynamics of Snowfinches." />
  <meta name="github-repo" content="fraenzi/popmod_snowfinch" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Data | A predictive population model for a high-elevation specialist bird species" />
  
  <meta name="twitter:description" content="We here present what we know about population dynamics of Snowfinches." />
  <meta name="twitter:image" content="/figures/sf.jpg" />

<meta name="author" content="FrÃ¤nzi Korner-Nievergelt" />


<meta name="date" content="2023-10-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="population-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#background"><i class="fa fa-check"></i><b>1.1</b> Background</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#model-structure"><i class="fa fa-check"></i><b>1.2</b> Model structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#environmental-data"><i class="fa fa-check"></i><b>2.1</b> Environmental data</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#demographic-data"><i class="fa fa-check"></i><b>2.2</b> Demographic data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data.html"><a href="data.html#number-of-broods"><i class="fa fa-check"></i><b>2.2.1</b> Number of broods</a></li>
<li class="chapter" data-level="2.2.2" data-path="data.html"><a href="data.html#number-of-fledglings"><i class="fa fa-check"></i><b>2.2.2</b> Number of fledglings</a></li>
<li class="chapter" data-level="2.2.3" data-path="data.html"><a href="data.html#survival"><i class="fa fa-check"></i><b>2.2.3</b> Survival</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="population-model.html"><a href="population-model.html"><i class="fa fa-check"></i><b>3</b> Population model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="population-model.html"><a href="population-model.html#starting-population"><i class="fa fa-check"></i><b>3.1</b> Starting population</a></li>
<li class="chapter" data-level="3.2" data-path="population-model.html"><a href="population-model.html#run-population-trajectory"><i class="fa fa-check"></i><b>3.2</b> Run population trajectory</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>4</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A predictive population model for a high-elevation specialist bird species</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Data<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<pre><code>## Warning: Paket &#39;basemaps&#39; wurde unter R Version 4.2.3 erstellt</code></pre>
<div id="environmental-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Environmental data<a href="data.html#environmental-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Environmental variables that have, up to now, been shown to affect population dynamics in Snowfinches are:<br />
- average temperature during the breeding season negatively affect apparent survival of female Snowfinches <span class="citation">(<a href="#ref-Strinella.2020">Eliseo Strinella et al. 2020</a>, own data)</span><br />
- date of snowmelt was correlated with the timing of the broods <span class="citation">(<a href="#ref-Schano.2021">Schano et al. 2021</a>)</span> and has an effect on nestling growth rate <span class="citation">(<a href="#ref-Ijjas.2022">Ijjas 2022</a>)</span><br />
- temperature early in the breeding season correlated positively with the length of the breeding season (and thus, number of broods possible) and average temperature late in the breeding season correlated negatively with the length of the breeding season (Niffenegger in prep.).</p>
<p>Average temperature values early and late during the breeding season, timing and duration of snowmelt were obtained from meteoschweiz for the years 1999 to 2021 [reference?].</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data.html#cb4-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/dwbreeding.rda&quot;</span>)</span>
<span id="cb4-2"><a href="data.html#cb4-2" tabindex="-1"></a><span class="fu">pairs</span>(dwbreeding[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)])</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="predictive_model_files/figure-html/unnamed-chunk-1-1.png" alt="Scatter plot of (standardised) temperature early and late during the breeding season, time and duration of snowmelt. All variables are standardised so that their mean is zero and their standard deviation one." width="672" />
<p class="caption">
Figure 2.1: Scatter plot of (standardised) temperature early and late during the breeding season, time and duration of snowmelt. All variables are standardised so that their mean is zero and their standard deviation one.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data.html#cb5-1" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: we could used a colour grade for the year</span></span></code></pre></div>
</div>
<div id="demographic-data" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Demographic data<a href="data.html#demographic-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="number-of-broods" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Number of broods<a href="data.html#number-of-broods" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data.html#cb6-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/broods.rda&quot;</span>)</span>
<span id="cb6-2"><a href="data.html#cb6-2" tabindex="-1"></a>nbroodspyear <span class="ot">&lt;-</span> <span class="fu">table</span>(dat<span class="sc">$</span>femaleID, dat<span class="sc">$</span>year)</span>
<span id="cb6-3"><a href="data.html#cb6-3" tabindex="-1"></a>nsec <span class="ot">&lt;-</span> <span class="fu">apply</span>(nbroodspyear, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x<span class="sc">==</span><span class="dv">2</span>))</span>
<span id="cb6-4"><a href="data.html#cb6-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">apply</span>(nbroodspyear, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x<span class="sc">&gt;</span><span class="dv">0</span>))</span></code></pre></div>
<p>The number of broods a female raises in one year is only known for a few study sites. In the Apennine, 26 out of 26 females did a second brood <span class="citation">(<a href="#ref-strinella_biologia_2011">E. Strinella et al. 2011</a>)</span>. In the Pyrenees, <span class="citation">GrangÃ© (<a href="#ref-grange_biologie_2008">2008</a>)</span> observed that 50% of the breeding pairs did a second brood. Little is known for the Alps. <span class="citation">Aichhorn (<a href="#ref-Aichhorn.1966">1966</a>)</span> found in the Austrian Alps that 9 of 11 breeding pairs did a second brood. In our study in the Swiss Alps, we could detect only 7 females doing a second brood out of 48 females that were reported to breed. However, we may have missed a large part of the second broods because females may leave the study area for the second brood.
The proportion of non-breeding females is not known at all.</p>
<p>To more precisely assess the proportion of females that skip breeding, do one or two broods, it would be necessary to track females over the course of the whole breeding season. This has not been done yet.</p>
<p>We use a hierarchical meta-analysis to combine the information from the different studies including our own. To do so, we use a binomial mixed model for the number of females that were reported to do a second brood. The study was used as a random factor to account for among-study variance.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data.html#cb7-1" tabindex="-1"></a>litdat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/demography_lit.txt&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb7-2"><a href="data.html#cb7-2" tabindex="-1"></a>litdat<span class="sc">$</span>FirstAuthor[litdat<span class="sc">$</span>FirstAuthor<span class="sc">==</span><span class="st">&quot;Grang</span><span class="sc">\xe9</span><span class="st">&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Grange&quot;</span></span>
<span id="cb7-3"><a href="data.html#cb7-3" tabindex="-1"></a>index <span class="ot">&lt;-</span> litdat<span class="sc">$</span>parameter_name<span class="sc">==</span><span class="st">&quot;prop_second_brood&quot;</span></span>
<span id="cb7-4"><a href="data.html#cb7-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> litdat<span class="sc">$</span>par_value[index]</span>
<span id="cb7-5"><a href="data.html#cb7-5" tabindex="-1"></a>y.n <span class="ot">&lt;-</span> litdat<span class="sc">$</span>sample_size[index]</span>
<span id="cb7-6"><a href="data.html#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="data.html#cb7-7" tabindex="-1"></a>yb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(y<span class="sc">*</span>y.n), <span class="fu">round</span>((<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">*</span>y.n))</span>
<span id="cb7-8"><a href="data.html#cb7-8" tabindex="-1"></a>studyID <span class="ot">&lt;-</span> <span class="fu">paste</span>(litdat<span class="sc">$</span>FirstAuthor[index], litdat<span class="sc">$</span>Jahr[index])</span>
<span id="cb7-9"><a href="data.html#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="data.html#cb7-10" tabindex="-1"></a>yb <span class="ot">&lt;-</span> <span class="fu">rbind</span>(yb, <span class="fu">c</span>(<span class="fu">sum</span>(nsec), <span class="fu">sum</span>(n)<span class="sc">-</span><span class="fu">sum</span>(nsec)))</span>
<span id="cb7-11"><a href="data.html#cb7-11" tabindex="-1"></a>studyID <span class="ot">&lt;-</span> <span class="fu">c</span>(studyID, <span class="st">&quot;own data&quot;</span>)</span>
<span id="cb7-12"><a href="data.html#cb7-12" tabindex="-1"></a>yb <span class="ot">&lt;-</span> yb[<span class="fu">rev</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(yb)),]</span>
<span id="cb7-13"><a href="data.html#cb7-13" tabindex="-1"></a>studyID <span class="ot">&lt;-</span> <span class="fu">rev</span>(studyID)</span>
<span id="cb7-14"><a href="data.html#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="data.html#cb7-15" tabindex="-1"></a>lwr <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="at">p=</span><span class="fl">0.025</span>, yb[,<span class="dv">1</span>], yb[,<span class="dv">2</span>])</span>
<span id="cb7-16"><a href="data.html#cb7-16" tabindex="-1"></a>upr <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="at">p=</span><span class="fl">0.975</span>, yb[,<span class="dv">1</span>], yb[,<span class="dv">2</span>])</span>
<span id="cb7-17"><a href="data.html#cb7-17" tabindex="-1"></a></span>
<span id="cb7-18"><a href="data.html#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="data.html#cb7-19" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(yb<span class="sc">~</span><span class="dv">1</span> <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>studyID), <span class="at">family=</span>binomial)</span>
<span id="cb7-20"><a href="data.html#cb7-20" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb7-21"><a href="data.html#cb7-21" tabindex="-1"></a>bsim <span class="ot">&lt;-</span> <span class="fu">sim</span>(mod, <span class="at">n.sim=</span>nsim)</span>
<span id="cb7-22"><a href="data.html#cb7-22" tabindex="-1"></a>my <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">mean</span>(<span class="fu">fixef</span>(bsim)[,<span class="dv">1</span>]))</span>
<span id="cb7-23"><a href="data.html#cb7-23" tabindex="-1"></a>my.lwr <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">quantile</span>(<span class="fu">fixef</span>(bsim)[,<span class="dv">1</span>], <span class="at">probs=</span><span class="fl">0.025</span>))</span>
<span id="cb7-24"><a href="data.html#cb7-24" tabindex="-1"></a>my.upr <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">quantile</span>(<span class="fu">fixef</span>(bsim)[,<span class="dv">1</span>], <span class="at">probs=</span><span class="fl">0.975</span>))</span>
<span id="cb7-25"><a href="data.html#cb7-25" tabindex="-1"></a></span>
<span id="cb7-26"><a href="data.html#cb7-26" tabindex="-1"></a>y <span class="ot">&lt;-</span> yb[,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">apply</span>(yb, <span class="dv">1</span>, sum)</span>
<span id="cb7-27"><a href="data.html#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a href="data.html#cb7-28" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb7-29"><a href="data.html#cb7-29" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fu">length</span>(y)<span class="sc">+</span><span class="dv">1</span>), <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Proportion second broods&quot;</span>, <span class="at">ylab=</span><span class="cn">NA</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb7-30"><a href="data.html#cb7-30" tabindex="-1"></a><span class="fu">segments</span>(lwr, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y), upr, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y))</span>
<span id="cb7-31"><a href="data.html#cb7-31" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y), <span class="at">labels=</span>studyID, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb7-32"><a href="data.html#cb7-32" tabindex="-1"></a><span class="fu">segments</span>(my.lwr, <span class="sc">-</span><span class="fl">0.5</span>, my.upr, <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb7-33"><a href="data.html#cb7-33" tabindex="-1"></a><span class="fu">points</span>(my, <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">pch=</span><span class="dv">24</span>, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb7-34"><a href="data.html#cb7-34" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">labels=</span><span class="st">&quot;mean&quot;</span>,</span>
<span id="cb7-35"><a href="data.html#cb7-35" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb7-36"><a href="data.html#cb7-36" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(y)), <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y), <span class="at">labels=</span><span class="fu">apply</span>(yb, <span class="dv">1</span>, sum))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:metanrbrood"></span>
<img src="predictive_model_files/figure-html/metanrbrood-1.png" alt="Reported proportion of second broods in different studies (point) with 95% uncertainty intervals. The mean (grey) is the average overa all studies, taking different sample sizes into account. The sample sizes, i.e. number of females doing at least one brood, are given for each study." width="672" />
<p class="caption">
Figure 2.2: Reported proportion of second broods in different studies (point) with 95% uncertainty intervals. The mean (grey) is the average overa all studies, taking different sample sizes into account. The sample sizes, i.e.Â number of females doing at least one brood, are given for each study.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data.html#cb8-1" tabindex="-1"></a><span class="co"># estimate of proportion of non-breeding females 0.1 (95% UI: 0.03 - 0.23), corresponds to SE of 0.05</span></span>
<span id="cb8-2"><a href="data.html#cb8-2" tabindex="-1"></a>p0brood <span class="ot">&lt;-</span> <span class="fl">0.1</span>   <span class="co"># proportion of non-breeding females</span></span>
<span id="cb8-3"><a href="data.html#cb8-3" tabindex="-1"></a>p0brood.se <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># SE of proportion of non-breeding females</span></span>
<span id="cb8-4"><a href="data.html#cb8-4" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-5"><a href="data.html#cb8-5" tabindex="-1"></a>p0brood.r <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(nsim, <span class="fu">shapeparameter</span>(p0brood, <span class="at">se=</span>p0brood.se)<span class="sc">$</span>a, <span class="fu">shapeparameter</span>(p0brood, <span class="at">se=</span>p0brood.se)<span class="sc">$</span>b)</span></code></pre></div>
<p>The resulting average proportion of second broods has a high uncertainty. Its 95% uncertainty interval ranges from 0.21 to 0.97, and the mean is 0.75 (Figure <a href="data.html#fig:metanrbrood">2.2</a>).</p>
<p>For the population model, we use a proportion of non-breeding females of 0.1 in average and an uncertainty interval of 0.02 to 0.21 to account for the fact that we know little about this demographic parameter.</p>
<p>We derive the two intercepts of a multinomial model from the proportion of non-breeders and the proportion of females with second broods among the breeding females using Monte Carlo simulations to propagate the uncertainty. The proportions defined by the intercept are used for average temperature values.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data.html#cb9-1" tabindex="-1"></a><span class="co"># derivation of formula to calculate the intercepts</span></span>
<span id="cb9-2"><a href="data.html#cb9-2" tabindex="-1"></a><span class="co"># p0brood = exp(x1)/(exp(x1) + exp(x2) + 1)</span></span>
<span id="cb9-3"><a href="data.html#cb9-3" tabindex="-1"></a><span class="co"># p1brood = exp(x2)/(exp(x1) + exp(x2) + 1)</span></span>
<span id="cb9-4"><a href="data.html#cb9-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-5"><a href="data.html#cb9-5" tabindex="-1"></a><span class="co"># p0brood*(exp(x1) + exp(x2) + 1) = exp(x1)</span></span>
<span id="cb9-6"><a href="data.html#cb9-6" tabindex="-1"></a><span class="co"># p1brood*(exp(x1) + exp(x2) + 1) = exp(x2)</span></span>
<span id="cb9-7"><a href="data.html#cb9-7" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-8"><a href="data.html#cb9-8" tabindex="-1"></a><span class="co"># p0brood*exp(x1) + p0brood*exp(x2) + p0brood = exp(x1)</span></span>
<span id="cb9-9"><a href="data.html#cb9-9" tabindex="-1"></a><span class="co"># p0brood*exp(x2) + p0brood = exp(x1) - p0brood*exp(x1) = exp(x1)*(1-p0brood)</span></span>
<span id="cb9-10"><a href="data.html#cb9-10" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-11"><a href="data.html#cb9-11" tabindex="-1"></a><span class="co"># exp(x1) = (p0brood*exp(x2) + p0brood)/(1-p0brood)</span></span>
<span id="cb9-12"><a href="data.html#cb9-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-13"><a href="data.html#cb9-13" tabindex="-1"></a><span class="co"># p1brood*((p0brood*exp(x2) + p0brood)/(1-p0brood) + exp(x2) + 1) = exp(x2)</span></span>
<span id="cb9-14"><a href="data.html#cb9-14" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-15"><a href="data.html#cb9-15" tabindex="-1"></a><span class="co"># p1brood*(p0brood*exp(x2) + p0brood)/(1-p0brood) + p1brood*exp(x2) + p1brood = exp(x2)</span></span>
<span id="cb9-16"><a href="data.html#cb9-16" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-17"><a href="data.html#cb9-17" tabindex="-1"></a><span class="co"># (p1brood/(1-p0brood))*p0brood*exp(x2) + (p1brood/(1-p0brood))*p0brood + p1brood*exp(x2) + p1brood = exp(x2)</span></span>
<span id="cb9-18"><a href="data.html#cb9-18" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-19"><a href="data.html#cb9-19" tabindex="-1"></a><span class="co"># (p1brood*p0brood/(1-p0brood))  + p1brood = exp(x2) -(p1brood*p0brood/(1-p0brood))*exp(x2) - p1brood*exp(x2)</span></span>
<span id="cb9-20"><a href="data.html#cb9-20" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-21"><a href="data.html#cb9-21" tabindex="-1"></a><span class="co"># (p1brood*p0brood/(1-p0brood))  + p1brood = exp(x2)*(1-(p1brood*p0brood/(1-p0brood)) - p1brood)</span></span>
<span id="cb9-22"><a href="data.html#cb9-22" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-23"><a href="data.html#cb9-23" tabindex="-1"></a><span class="co"># exp(x2) = ((p1brood*p0brood/(1-p0brood))  + p1brood)/(1-(p1brood*p0brood/(1-p0brood)) - p1brood)</span></span>
<span id="cb9-24"><a href="data.html#cb9-24" tabindex="-1"></a><span class="co"># exp(x1) = (p0brood*exp(x2) + p0brood)/(1-p0brood)</span></span>
<span id="cb9-25"><a href="data.html#cb9-25" tabindex="-1"></a></span>
<span id="cb9-26"><a href="data.html#cb9-26" tabindex="-1"></a><span class="co"># specify proportion of pairs without and with only 1 brood </span></span>
<span id="cb9-27"><a href="data.html#cb9-27" tabindex="-1"></a><span class="co"># for average June and July temperature</span></span>
<span id="cb9-28"><a href="data.html#cb9-28" tabindex="-1"></a>my.se <span class="ot">&lt;-</span> (my.upr<span class="sc">-</span>my.lwr)<span class="sc">/</span><span class="dv">4</span>  <span class="co"># SE of prop second brood among breeders</span></span>
<span id="cb9-29"><a href="data.html#cb9-29" tabindex="-1"></a>my.r <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(nsim, <span class="fu">shapeparameter</span>(my, <span class="at">se=</span>my.se)<span class="sc">$</span>a, <span class="fu">shapeparameter</span>(my, <span class="at">se=</span>my.se)<span class="sc">$</span>b)</span>
<span id="cb9-30"><a href="data.html#cb9-30" tabindex="-1"></a></span>
<span id="cb9-31"><a href="data.html#cb9-31" tabindex="-1"></a>p1brood.r <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>my.r)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0brood.r)  <span class="co"># proportion of single brooded pairs</span></span>
<span id="cb9-32"><a href="data.html#cb9-32" tabindex="-1"></a></span>
<span id="cb9-33"><a href="data.html#cb9-33" tabindex="-1"></a></span>
<span id="cb9-34"><a href="data.html#cb9-34" tabindex="-1"></a><span class="co"># derive the two intercepts of the multinomial model</span></span>
<span id="cb9-35"><a href="data.html#cb9-35" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">log</span>(((p1brood.r<span class="sc">*</span>p0brood.r<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p0brood.r))  <span class="sc">+</span> p1brood.r)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>(p1brood.r<span class="sc">*</span>p0brood.r<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p0brood.r)) <span class="sc">-</span> p1brood.r))</span>
<span id="cb9-36"><a href="data.html#cb9-36" tabindex="-1"></a>x1  <span class="ot">&lt;-</span> <span class="fu">log</span>((p0brood.r<span class="sc">*</span><span class="fu">exp</span>(x2) <span class="sc">+</span> p0brood.r)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p0brood.r))</span>
<span id="cb9-37"><a href="data.html#cb9-37" tabindex="-1"></a>x1.se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x1) </span>
<span id="cb9-38"><a href="data.html#cb9-38" tabindex="-1"></a>x2.se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x2)</span></code></pre></div>
<p>Citizen science data (ornitho.ch) revealed that during the last 20 years, the Snowfinch breeding season started mid May when June temperatures were high and it started mid June, when June temperatures were low (Niffenegger in prep.). Also, we saw that the end of the breeding season varied between the beginning of August to the end of August depending on July temperature. The warmer in July, the earlier was the end of the breeding season. Thus, both temperature variables (June and July temperature) may affect the number of broods by one brood (for which around one month is needed) along their ranges of values. We derive effect sizes for June and July temperature that correspond to a change by one brood from the lowest to the highest temperature values.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data.html#cb10-1" tabindex="-1"></a><span class="co"># derive the effect sizes of June and July temperature</span></span>
<span id="cb10-2"><a href="data.html#cb10-2" tabindex="-1"></a><span class="co"># We use 4 standard deviations as the range from low to high </span></span>
<span id="cb10-3"><a href="data.html#cb10-3" tabindex="-1"></a><span class="co"># the effect size to get 1 brood more or less in a logistic regression is around plus or minus 4 (per 4 SD of temperature values)</span></span>
<span id="cb10-4"><a href="data.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="data.html#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="data.html#cb10-6" tabindex="-1"></a>b1nbrood <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span>     <span class="co"># effect of June temperature</span></span>
<span id="cb10-7"><a href="data.html#cb10-7" tabindex="-1"></a>b1nbrood.se <span class="ot">&lt;-</span> <span class="fl">0.3</span>  <span class="co"># uncertainty (SE) for the effect of June temperature</span></span>
<span id="cb10-8"><a href="data.html#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="data.html#cb10-9" tabindex="-1"></a>b2nbrood <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co"># effect of July temperature</span></span>
<span id="cb10-10"><a href="data.html#cb10-10" tabindex="-1"></a>b2nbrood.se <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># uncertainty for the effect of July temperature</span></span>
<span id="cb10-11"><a href="data.html#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="data.html#cb10-12" tabindex="-1"></a>nrbroods <span class="ot">&lt;-</span> <span class="cf">function</span>(n, env1, env2, <span class="at">b1=</span><span class="cn">NA</span>, <span class="at">b2=</span><span class="cn">NA</span>, <span class="at">b0=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.07</span>,<span class="sc">-</span><span class="fl">1.97</span>)){</span>
<span id="cb10-13"><a href="data.html#cb10-13" tabindex="-1"></a>  <span class="co"># environmental variable (year-specific)</span></span>
<span id="cb10-14"><a href="data.html#cb10-14" tabindex="-1"></a>  eta1 <span class="ot">&lt;-</span> b0[<span class="dv">1</span>] <span class="sc">+</span> b1<span class="sc">*</span>env1 <span class="sc">+</span> b2<span class="sc">*</span>env2</span>
<span id="cb10-15"><a href="data.html#cb10-15" tabindex="-1"></a>  eta2 <span class="ot">&lt;-</span> b0[<span class="dv">2</span>] <span class="sc">+</span> b1<span class="sc">*</span>env1 <span class="sc">+</span> b2<span class="sc">*</span>env2</span>
<span id="cb10-16"><a href="data.html#cb10-16" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">c</span>(eta1, eta2, <span class="dv">0</span>))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(<span class="fu">cbind</span>(eta1, eta2, <span class="dv">0</span>)))</span>
<span id="cb10-17"><a href="data.html#cb10-17" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span>probs)</span>
<span id="cb10-18"><a href="data.html#cb10-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">nb=</span>nb, <span class="at">probs=</span>probs))</span>
<span id="cb10-19"><a href="data.html#cb10-19" tabindex="-1"></a>}</span>
<span id="cb10-20"><a href="data.html#cb10-20" tabindex="-1"></a></span>
<span id="cb10-21"><a href="data.html#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="data.html#cb10-22" tabindex="-1"></a><span class="co"># Effect of June-temperature (env1)</span></span>
<span id="cb10-23"><a href="data.html#cb10-23" tabindex="-1"></a>env1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb10-24"><a href="data.html#cb10-24" tabindex="-1"></a>env2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-25"><a href="data.html#cb10-25" tabindex="-1"></a></span>
<span id="cb10-26"><a href="data.html#cb10-26" tabindex="-1"></a>probssim <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim=</span><span class="fu">c</span>(nsim, <span class="fu">length</span>(env1), <span class="dv">3</span>))</span>
<span id="cb10-27"><a href="data.html#cb10-27" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb10-28"><a href="data.html#cb10-28" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(env1)){</span>
<span id="cb10-29"><a href="data.html#cb10-29" tabindex="-1"></a>    x1r <span class="ot">&lt;-</span> x1[i]</span>
<span id="cb10-30"><a href="data.html#cb10-30" tabindex="-1"></a>    x2r <span class="ot">&lt;-</span> x2[i]</span>
<span id="cb10-31"><a href="data.html#cb10-31" tabindex="-1"></a>    b1r <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, b1nbrood, b1nbrood.se)</span>
<span id="cb10-32"><a href="data.html#cb10-32" tabindex="-1"></a>    b2r <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, b2nbrood, b2nbrood.se)</span>
<span id="cb10-33"><a href="data.html#cb10-33" tabindex="-1"></a>    probssim[i,k,] <span class="ot">&lt;-</span> <span class="fu">nrbroods</span>(<span class="dv">1</span>, env1[k],env2, <span class="at">b1=</span>b1r, <span class="at">b2=</span>b2r,<span class="at">b0=</span><span class="fu">c</span>(x1r, x2r))<span class="sc">$</span>probs</span>
<span id="cb10-34"><a href="data.html#cb10-34" tabindex="-1"></a>  }</span>
<span id="cb10-35"><a href="data.html#cb10-35" tabindex="-1"></a>}</span>
<span id="cb10-36"><a href="data.html#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="data.html#cb10-37" tabindex="-1"></a>probscum <span class="ot">&lt;-</span> probssim</span>
<span id="cb10-38"><a href="data.html#cb10-38" tabindex="-1"></a>probscum[,,<span class="dv">2</span>] <span class="ot">&lt;-</span> probssim[,,<span class="dv">1</span>] <span class="sc">+</span> probssim[,,<span class="dv">2</span>]</span>
<span id="cb10-39"><a href="data.html#cb10-39" tabindex="-1"></a>probscum[,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-40"><a href="data.html#cb10-40" tabindex="-1"></a></span>
<span id="cb10-41"><a href="data.html#cb10-41" tabindex="-1"></a>probsm <span class="ot">&lt;-</span> <span class="fu">apply</span>(probscum, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean)</span>
<span id="cb10-42"><a href="data.html#cb10-42" tabindex="-1"></a>probslwr <span class="ot">&lt;-</span> <span class="fu">apply</span>(probscum, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb10-43"><a href="data.html#cb10-43" tabindex="-1"></a>probsupr <span class="ot">&lt;-</span> <span class="fu">apply</span>(probscum, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb10-44"><a href="data.html#cb10-44" tabindex="-1"></a></span>
<span id="cb10-45"><a href="data.html#cb10-45" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.1</span>))</span>
<span id="cb10-46"><a href="data.html#cb10-46" tabindex="-1"></a><span class="fu">plot</span>(env1, probsm[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&quot;Proportion of females&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;June temperature&quot;</span>)</span>
<span id="cb10-47"><a href="data.html#cb10-47" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(env1, <span class="fu">rev</span>(env1)), <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(env1)), <span class="fu">rev</span>(probsm[,<span class="dv">1</span>])), <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb10-48"><a href="data.html#cb10-48" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb10-49"><a href="data.html#cb10-49" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(env1, <span class="fu">rev</span>(env1)), <span class="fu">c</span>(probsm[,<span class="dv">1</span>], <span class="fu">rev</span>(probsm[,<span class="dv">2</span>])), <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb10-50"><a href="data.html#cb10-50" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb10-51"><a href="data.html#cb10-51" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(env1, <span class="fu">rev</span>(env1)), <span class="fu">c</span>(probsm[,<span class="dv">2</span>], <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(env1))), <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb10-52"><a href="data.html#cb10-52" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-53"><a href="data.html#cb10-53" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-54"><a href="data.html#cb10-54" tabindex="-1"></a> <span class="fu">lines</span>(env1, probslwr[,<span class="dv">1</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-55"><a href="data.html#cb10-55" tabindex="-1"></a> <span class="fu">lines</span>(env1, probsupr[,<span class="dv">1</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-56"><a href="data.html#cb10-56" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-57"><a href="data.html#cb10-57" tabindex="-1"></a> <span class="fu">lines</span>(env1, probslwr[,<span class="dv">2</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-58"><a href="data.html#cb10-58" tabindex="-1"></a> <span class="fu">lines</span>(env1, probsupr[,<span class="dv">2</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-59"><a href="data.html#cb10-59" tabindex="-1"></a></span>
<span id="cb10-60"><a href="data.html#cb10-60" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="fl">1.25</span>, <span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;brown&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;no brood&quot;</span>, <span class="st">&quot;1 brood&quot;</span>, <span class="st">&quot;2 broods&quot;</span>), <span class="at">horiz=</span><span class="cn">TRUE</span>, <span class="at">xpd=</span><span class="cn">NA</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb10-61"><a href="data.html#cb10-61" tabindex="-1"></a></span>
<span id="cb10-62"><a href="data.html#cb10-62" tabindex="-1"></a></span>
<span id="cb10-63"><a href="data.html#cb10-63" tabindex="-1"></a><span class="co"># Effect of July-temperature (env2)</span></span>
<span id="cb10-64"><a href="data.html#cb10-64" tabindex="-1"></a>env1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-65"><a href="data.html#cb10-65" tabindex="-1"></a>env2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb10-66"><a href="data.html#cb10-66" tabindex="-1"></a></span>
<span id="cb10-67"><a href="data.html#cb10-67" tabindex="-1"></a>probssim <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim=</span><span class="fu">c</span>(nsim, <span class="fu">length</span>(env2), <span class="dv">3</span>))</span>
<span id="cb10-68"><a href="data.html#cb10-68" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb10-69"><a href="data.html#cb10-69" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(env2)){</span>
<span id="cb10-70"><a href="data.html#cb10-70" tabindex="-1"></a>    x1r <span class="ot">&lt;-</span> x1[i]</span>
<span id="cb10-71"><a href="data.html#cb10-71" tabindex="-1"></a>    x2r <span class="ot">&lt;-</span> x2[i]</span>
<span id="cb10-72"><a href="data.html#cb10-72" tabindex="-1"></a>    b1r <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, b1nbrood, b1nbrood.se)</span>
<span id="cb10-73"><a href="data.html#cb10-73" tabindex="-1"></a>    b2r <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, b2nbrood, b2nbrood.se)</span>
<span id="cb10-74"><a href="data.html#cb10-74" tabindex="-1"></a>    probssim[i,k,] <span class="ot">&lt;-</span> <span class="fu">nrbroods</span>(<span class="dv">1</span>, env1,env2[k], <span class="at">b1=</span>b1r, <span class="at">b2=</span>b2r,<span class="at">b0=</span><span class="fu">c</span>(x1r, x2r))<span class="sc">$</span>probs</span>
<span id="cb10-75"><a href="data.html#cb10-75" tabindex="-1"></a>  }</span>
<span id="cb10-76"><a href="data.html#cb10-76" tabindex="-1"></a>}</span>
<span id="cb10-77"><a href="data.html#cb10-77" tabindex="-1"></a></span>
<span id="cb10-78"><a href="data.html#cb10-78" tabindex="-1"></a>probscum <span class="ot">&lt;-</span> probssim</span>
<span id="cb10-79"><a href="data.html#cb10-79" tabindex="-1"></a>probscum[,,<span class="dv">2</span>] <span class="ot">&lt;-</span> probssim[,,<span class="dv">1</span>] <span class="sc">+</span> probssim[,,<span class="dv">2</span>]</span>
<span id="cb10-80"><a href="data.html#cb10-80" tabindex="-1"></a>probscum[,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-81"><a href="data.html#cb10-81" tabindex="-1"></a></span>
<span id="cb10-82"><a href="data.html#cb10-82" tabindex="-1"></a>probsm <span class="ot">&lt;-</span> <span class="fu">apply</span>(probscum, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean)</span>
<span id="cb10-83"><a href="data.html#cb10-83" tabindex="-1"></a>probslwr <span class="ot">&lt;-</span> <span class="fu">apply</span>(probscum, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb10-84"><a href="data.html#cb10-84" tabindex="-1"></a>probsupr <span class="ot">&lt;-</span> <span class="fu">apply</span>(probscum, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb10-85"><a href="data.html#cb10-85" tabindex="-1"></a></span>
<span id="cb10-86"><a href="data.html#cb10-86" tabindex="-1"></a><span class="fu">plot</span>(env2, probsm[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="cn">NA</span>, <span class="at">xlab=</span><span class="st">&quot;July temperature&quot;</span>)</span>
<span id="cb10-87"><a href="data.html#cb10-87" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(env2, <span class="fu">rev</span>(env2)), <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(env2)), <span class="fu">rev</span>(probsm[,<span class="dv">1</span>])), <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb10-88"><a href="data.html#cb10-88" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb10-89"><a href="data.html#cb10-89" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(env2, <span class="fu">rev</span>(env2)), <span class="fu">c</span>(probsm[,<span class="dv">1</span>], <span class="fu">rev</span>(probsm[,<span class="dv">2</span>])), <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb10-90"><a href="data.html#cb10-90" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb10-91"><a href="data.html#cb10-91" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(env2, <span class="fu">rev</span>(env2)), <span class="fu">c</span>(probsm[,<span class="dv">2</span>], <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(env2))), <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb10-92"><a href="data.html#cb10-92" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-93"><a href="data.html#cb10-93" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-94"><a href="data.html#cb10-94" tabindex="-1"></a> <span class="fu">lines</span>(env2, probslwr[,<span class="dv">1</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-95"><a href="data.html#cb10-95" tabindex="-1"></a> <span class="fu">lines</span>(env2, probsupr[,<span class="dv">1</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-96"><a href="data.html#cb10-96" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-97"><a href="data.html#cb10-97" tabindex="-1"></a> <span class="fu">lines</span>(env2, probslwr[,<span class="dv">2</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb10-98"><a href="data.html#cb10-98" tabindex="-1"></a> <span class="fu">lines</span>(env2, probsupr[,<span class="dv">2</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="predictive_model_files/figure-html/unnamed-chunk-3-1.png" alt="Proportion of females with 0, 1 or 2 broods. The 95% uncertainty intervals are indicatd with white dotted lines. They visualise the lack of knowledge on the proportion of breeders and the proportion of second broods, as well as the uncertainty in the temperature effects." width="672" />
<p class="caption">
Figure 2.3: Proportion of females with 0, 1 or 2 broods. The 95% uncertainty intervals are indicatd with white dotted lines. They visualise the lack of knowledge on the proportion of breeders and the proportion of second broods, as well as the uncertainty in the temperature effects.
</p>
</div>
</div>
<div id="number-of-fledglings" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Number of fledglings<a href="data.html#number-of-fledglings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data.html#cb11-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> litdat<span class="sc">$</span>parameter_name<span class="sc">==</span> <span class="st">&quot;nfledglings&quot;</span></span>
<span id="cb11-2"><a href="data.html#cb11-2" tabindex="-1"></a>mnrfl <span class="ot">&lt;-</span> litdat<span class="sc">$</span>par_value[index]</span>
<span id="cb11-3"><a href="data.html#cb11-3" tabindex="-1"></a>mnrfl.sd <span class="ot">&lt;-</span> (litdat<span class="sc">$</span>max[index]<span class="sc">-</span>litdat<span class="sc">$</span>min[index])<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb11-4"><a href="data.html#cb11-4" tabindex="-1"></a>studyID <span class="ot">&lt;-</span> <span class="fu">paste</span>(litdat<span class="sc">$</span>FirstAuthor, litdat<span class="sc">$</span>Jahr)[index]</span></code></pre></div>
<p>There is only one study from the Pyrenees that report the number of fledglings <span class="citation">(<a href="#ref-grange_biologie_2008">GrangÃ© 2008</a>)</span>. They report an average of 2.4.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data.html#cb12-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/broods.rda&quot;</span>)</span>
<span id="cb12-2"><a href="data.html#cb12-2" tabindex="-1"></a>dbroods <span class="ot">&lt;-</span> dat</span>
<span id="cb12-3"><a href="data.html#cb12-3" tabindex="-1"></a><span class="co">#dbroods$number.of.fledglings</span></span>
<span id="cb12-4"><a href="data.html#cb12-4" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">is.na</span>(dbroods<span class="sc">$</span>number.of.fledglings)</span>
<span id="cb12-5"><a href="data.html#cb12-5" tabindex="-1"></a>dbroods<span class="sc">$</span>number.of.fledglings[index] <span class="ot">&lt;-</span> dbroods<span class="sc">$</span>number.of.nestlings_late[index]</span>
<span id="cb12-6"><a href="data.html#cb12-6" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">is.na</span>(dbroods<span class="sc">$</span>number.of.fledglings)</span>
<span id="cb12-7"><a href="data.html#cb12-7" tabindex="-1"></a>dbroods<span class="sc">$</span>number.of.fledglings[index] <span class="ot">&lt;-</span> dbroods<span class="sc">$</span>number.of.nestlings_early[index]</span>
<span id="cb12-8"><a href="data.html#cb12-8" tabindex="-1"></a>index <span class="ot">&lt;-</span> dbroods<span class="sc">$</span>number.of.fledglings<span class="sc">==</span><span class="dv">0</span>; index[<span class="fu">is.na</span>(index)] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb12-9"><a href="data.html#cb12-9" tabindex="-1"></a>dbroods <span class="ot">&lt;-</span> dbroods[<span class="sc">!</span><span class="fu">is.na</span>(dbroods<span class="sc">$</span>number.of.fledglings),]</span>
<span id="cb12-10"><a href="data.html#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="data.html#cb12-11" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">:</span></span>
<span id="cb12-12"><a href="data.html#cb12-12" tabindex="-1"></a><span class="co"># - change function so that stan_glmer objects can be handled, and inlcude information from literature</span></span>
<span id="cb12-13"><a href="data.html#cb12-13" tabindex="-1"></a><span class="co"># - include age of mother and father</span></span>
<span id="cb12-14"><a href="data.html#cb12-14" tabindex="-1"></a><span class="co"># - make number of nestlings dependent on the timing of the brood relative to snowmelt</span></span>
<span id="cb12-15"><a href="data.html#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="data.html#cb12-16" tabindex="-1"></a><span class="co"># date in relation to snowmelt</span></span>
<span id="cb12-17"><a href="data.html#cb12-17" tabindex="-1"></a>dbroods<span class="sc">$</span>doi_hatching <span class="ot">&lt;-</span> <span class="fu">dayofyear</span>(<span class="at">d=</span>dbroods<span class="sc">$</span>day.hatching.first.egg, </span>
<span id="cb12-18"><a href="data.html#cb12-18" tabindex="-1"></a>                                  <span class="at">m=</span>dbroods<span class="sc">$</span>month.hatching.first.egg,</span>
<span id="cb12-19"><a href="data.html#cb12-19" tabindex="-1"></a>                                  <span class="at">y=</span>dbroods<span class="sc">$</span>year)</span>
<span id="cb12-20"><a href="data.html#cb12-20" tabindex="-1"></a><span class="fu">plot</span>(number.of.fledglings<span class="sc">~</span>doi_hatching, dbroods)</span>
<span id="cb12-21"><a href="data.html#cb12-21" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(number.of.fledglings<span class="sc">~</span>doi_hatching, <span class="at">data=</span>dbroods)</span>
<span id="cb12-22"><a href="data.html#cb12-22" tabindex="-1"></a><span class="fu">abline</span>(mod)</span>
<span id="cb12-23"><a href="data.html#cb12-23" tabindex="-1"></a>bsimfledge <span class="ot">&lt;-</span> <span class="fu">sim</span>(mod, <span class="at">n.sim=</span>nsim)</span>
<span id="cb12-24"><a href="data.html#cb12-24" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">doi_hatching=</span><span class="dv">120</span><span class="sc">:</span><span class="dv">220</span>)</span>
<span id="cb12-25"><a href="data.html#cb12-25" tabindex="-1"></a>newdat<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata=</span>newdat)</span>
<span id="cb12-26"><a href="data.html#cb12-26" tabindex="-1"></a>newdat<span class="sc">$</span>lwr <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata=</span>newdat, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)[,<span class="dv">2</span>]</span>
<span id="cb12-27"><a href="data.html#cb12-27" tabindex="-1"></a>newdat<span class="sc">$</span>upr <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata=</span>newdat, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)[,<span class="dv">3</span>]</span>
<span id="cb12-28"><a href="data.html#cb12-28" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>doi_hatching, newdat<span class="sc">$</span>lwr, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb12-29"><a href="data.html#cb12-29" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>doi_hatching, newdat<span class="sc">$</span>upr, <span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="predictive_model_files/figure-html/nrfeldglings-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data.html#cb13-1" tabindex="-1"></a>nrfledglings <span class="ot">&lt;-</span> <span class="cf">function</span>(bsim, doi, <span class="at">nsim=</span><span class="dv">1</span>){</span>
<span id="cb13-2"><a href="data.html#cb13-2" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">doi=</span>doi)</span>
<span id="cb13-3"><a href="data.html#cb13-3" tabindex="-1"></a>  Xmat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>doi, <span class="at">data=</span>nd)</span>
<span id="cb13-4"><a href="data.html#cb13-4" tabindex="-1"></a>  fitmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol=</span>nsim, <span class="at">nrow=</span><span class="fu">nrow</span>(nd))</span>
<span id="cb13-5"><a href="data.html#cb13-5" tabindex="-1"></a>  newy <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol=</span>nsim, <span class="at">nrow=</span><span class="fu">nrow</span>(nd))</span>
<span id="cb13-6"><a href="data.html#cb13-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb13-7"><a href="data.html#cb13-7" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bsim<span class="sc">@</span>coef), nsim, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb13-8"><a href="data.html#cb13-8" tabindex="-1"></a>    fitmat[,i] <span class="ot">&lt;-</span> Xmat<span class="sc">%*%</span>bsim<span class="sc">@</span>coef[index[i],]</span>
<span id="cb13-9"><a href="data.html#cb13-9" tabindex="-1"></a>    newy[,i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="fu">nrow</span>(nd), <span class="at">mean=</span>fitmat[,i], <span class="at">sd=</span>bsim<span class="sc">@</span>sigma[index[i]]))</span>
<span id="cb13-10"><a href="data.html#cb13-10" tabindex="-1"></a>    newy[,i][newy[,i]<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb13-11"><a href="data.html#cb13-11" tabindex="-1"></a>  }</span>
<span id="cb13-12"><a href="data.html#cb13-12" tabindex="-1"></a>  <span class="fu">return</span>(newy)</span>
<span id="cb13-13"><a href="data.html#cb13-13" tabindex="-1"></a>}</span>
<span id="cb13-14"><a href="data.html#cb13-14" tabindex="-1"></a><span class="co">#yrep &lt;- nrfledglings(bsim=bsimfledge, doi=dbroods$doi_hatching[complete.cases(dbroods$doi_hatching)], nsim=1)</span></span>
<span id="cb13-15"><a href="data.html#cb13-15" tabindex="-1"></a><span class="co">#plot(dbroods$doi_hatching[complete.cases(dbroods$doi_hatching)], yrep[,1])</span></span></code></pre></div>
</div>
<div id="survival" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Survival<a href="data.html#survival" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="literature-view-on-survival-estimates-for-snowfinches" class="section level4 hasAnchor" number="2.2.3.1">
<h4><span class="header-section-number">2.2.3.1</span> Literature view on survival estimates for Snowfinches<a href="data.html#literature-view-on-survival-estimates-for-snowfinches" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is, as far as we know, only one published study on apparent survival in Snowfinches from the Appennine <span class="citation">(<a href="#ref-Strinella.2020">Eliseo Strinella et al. 2020</a>)</span>. The mark-recapture study took place between 2003 and 2017, and a couple of different mark-recapture models accounting for transients <span class="citation">(<a href="#ref-Pradel.1997">R. Pradel et al. 1997</a>)</span> were used to estimate annual apparent survival. Depending on the model used, they found annual apparent survival to be between 0.51 and 0.64 for adult females, between 0.44 and 0.54 for adult males and between 0.09 and 0.13 for first year birds. In addition, they found a strong negative correlation between apparent annual survival of adult females and average temperature during the breeding season. In the Austrian Alps, Ambros Aichhorn regularly ringed Snowfinches between 1964 and 2004 in winter. Also in these data, a strong negative correlation between temperature during the breeding season and female apparent survival is visible (own analyses in prep.). The average apparent annual survival was 0.63 (95% 0.56 - 0.70) in males and 0.50 (0.36 - 0.64) in females <span class="citation">(<a href="#ref-zauner_apparent_2022">Zauner 2022</a>)</span>.</p>
</div>
<div id="own-data-on-survival" class="section level4 hasAnchor" number="2.2.3.2">
<h4><span class="header-section-number">2.2.3.2</span> Own data on survival<a href="data.html#own-data-on-survival" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the project at the Swiss Ornithological Institute, we are marking individuals between since May 2015 and we perform systematic searches for marked individuals. Until August 2023 we collected over 8000 resightings and over 900 recaptures (Fig. <a href="data.html#fig:dataprepsurv">2.4</a>). Here, we present first, preliminary, analyses of those data and analyses results. The results are far from being perfect. The analyses serve to get an impression on how well we can estimate apparent survival, to identify gaps in the data and lack of knowledge, so that we can better plan our future research activities.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data.html#cb14-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/datax.rda&quot;</span>)</span>
<span id="cb14-2"><a href="data.html#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="data.html#cb14-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&#39;figures/CH_Snowfinch.jpg&#39;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:dataprepsurv"></span>
<img src="figures/CH_Snowfinch.jpg" alt="Marking- and capture/resighting data of Snowfinches in the project of the Swiss Ornithological Institute. Individuals are presented on the y-axis, the time is given on the x-axis. Dots are captures (blue as nestling, orange as fledged bird), open circles are resightings and brown crosses are findings of dead birds. Horizontal lines connect recaptures, resightings or findings of the same individual." width="3000" />
<p class="caption">
Figure 2.4: Marking- and capture/resighting data of Snowfinches in the project of the Swiss Ornithological Institute. Individuals are presented on the y-axis, the time is given on the x-axis. Dots are captures (blue as nestling, orange as fledged bird), open circles are resightings and brown crosses are findings of dead birds. Horizontal lines connect recaptures, resightings or findings of the same individual.
</p>
</div>
<p>We used alpha-numeric plastic rings to enable resightings of birds. Likely due to the cold in winter, the plastic rings break and get lost after some months. Birds without plastic rings only can get recaptured but no longer resighted. To account for that loss of plastic rings, we usesd a multi-state/multi-event model <span class="citation">Roger Pradel (<a href="#ref-pradel_multievent_2005">2005</a>)</span> adapted so that it accounts for loss of plastic rings <span class="citation">(<a href="#ref-laake_hidden_2014">Laake et al. 2014</a>)</span>. We divided the study period into 3-months intervals and collated the capture-recapture/resightings into an observation history matrix with a row per individual and plastic ring respectively. When an individual that has lost its plastic ring got a new plastic ring on a recapture, we defined that recapture to be a new release, i.e.Â we added a new observation history to the data matrix. Following <span class="citation">Laake et al. (<a href="#ref-laake_hidden_2014">2014</a>)</span>, we defined that the birds can be in 3 different states: 1=alive with metallic and plastic ring, 2=alive with metallic ring only, 3= dead. Transitions between states <span class="math inline">\(T\)</span> were defined by apparent survival probability <span class="math inline">\(\phi\)</span> and the probability to lose a plastic ring <span class="math inline">\(m\)</span>.</p>
<p><span class="math display">\[T =
  \left[ {\begin{array}{ccc}
    (1-m)\phi_{i,t} &amp; m\phi_{i,t} &amp; 1-\phi_{i,t} \\
    0 &amp; \phi_{i,t} &amp; 1-\phi_{i,t}\\
    0 &amp; 0 &amp;  1\\
  \end{array} } \right]
\]</span></p>
<p>Observation events are 1=individual is recorded wearing its plastic ring (resightings and recaptures), 2=individual is recorded without plastic ring (e.g.Â a recapture), 3=individual has not been seen or recaptured during the 3-months interval. We defined two different probabilities to record an individual during a 3-months interval, one for individuals having a plastic ring <span class="math inline">\(p^*\)</span> and one for individuals without a plastic ring <span class="math inline">\(p\)</span>. Depending on the state of the individuals, they can be recorded according to the observation matrix:</p>
<p><span class="math display">\[O =
  \left[ {\begin{array}{ccc}
    p^* &amp; 0 &amp; 1-p^* \\
    0 &amp; p &amp; 1-p\\
    0 &amp; 0 &amp;  1\\
  \end{array} } \right]
\]</span></p>
<p>Apparent survival and recapture/resighting probabilities were estimated independently for each age class (first half year vs.Â older than half a year), sex and season. We assume that ring loss probability is constant.</p>
<p>The preliminary results presented here, need to be handled with care because important relevant structures are still missing from the model. For example:</p>
<ul>
<li><p>Probability that a plastic ring is lost varies among ring series. A random factor for the ring series could be added as predictor for re-sighting probability <span class="math inline">\(p^*\)</span>.</p></li>
<li><p>Many individuals are first captured in winter which makes it likely that our data contains a high amount of so-called transients, i.e.Â individuals that are marked and then move away from our study site. It could be accounted for such transients in the model.</p></li>
<li><p>No among-year variance in apparent survival is yet included in the model.</p></li>
<li><p>No among-individual variance in apparent survival nor in recapture/resighting probability other than age and sex is included in the model yet.</p></li>
<li><p>First year birds are only treated as first year birds until December. Later, it is assumed that apparent survival of these birds is equal to adults (see below).</p></li>
<li><p>Resightings made outside our study area could be used to model movements and, consequently, we could get closer to true instead of apparent survival.</p></li>
</ul>
<p>We are happy to hear of further thoughts and ideas on how to improve the survival estimation.</p>
<p>We fitted the model using Markov chain Monte Carlo simulations as implemented in Jags <span class="citation">(<a href="#ref-Plummer2003">Plummer 2003</a>)</span>. The <a href="jags/survmod_bird_ring.txt">Jags code</a> is provided within this Github project.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data.html#cb15-1" tabindex="-1"></a>initfun <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb15-2"><a href="data.html#cb15-2" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">a0=</span><span class="fu">array</span>(<span class="fu">runif</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span><span class="dv">3</span>, <span class="dv">0</span>,<span class="dv">1</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb15-3"><a href="data.html#cb15-3" tabindex="-1"></a>       <span class="at">b0=</span><span class="fu">array</span>(<span class="fu">runif</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span><span class="dv">3</span>, <span class="dv">0</span>,<span class="dv">1</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb15-4"><a href="data.html#cb15-4" tabindex="-1"></a>       <span class="at">d0=</span><span class="fu">array</span>(<span class="fu">runif</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">2</span><span class="sc">*</span><span class="dv">3</span>, <span class="dv">0</span>,<span class="dv">1</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)))</span>
<span id="cb15-5"><a href="data.html#cb15-5" tabindex="-1"></a>}</span>
<span id="cb15-6"><a href="data.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="data.html#cb15-7" tabindex="-1"></a><span class="co"># mod &lt;- jags(datax, inits=initfun, </span></span>
<span id="cb15-8"><a href="data.html#cb15-8" tabindex="-1"></a><span class="co">#             parameters.to.save=c(&quot;a0&quot;, &quot;b0&quot;, &quot;d0&quot;, &quot;m&quot;, &quot;pfem&quot;),</span></span>
<span id="cb15-9"><a href="data.html#cb15-9" tabindex="-1"></a><span class="co">#             model.file=&quot;jags/survmod_bird_and_ring.txt&quot;, n.iter=5000, n.chains=3)</span></span>
<span id="cb15-10"><a href="data.html#cb15-10" tabindex="-1"></a><span class="co"># mod1 &lt;- mod$BUGSoutput</span></span>
<span id="cb15-11"><a href="data.html#cb15-11" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;modelfits/mod_231011.rda&quot;</span>)</span>
<span id="cb15-12"><a href="data.html#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="data.html#cb15-13" tabindex="-1"></a><span class="co">#traceplot(mod1)</span></span>
<span id="cb15-14"><a href="data.html#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="data.html#cb15-15" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">length=</span><span class="dv">4</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">las=</span><span class="dv">1</span>,</span>
<span id="cb15-16"><a href="data.html#cb15-16" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;3-months apparent survival&quot;</span>, <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb15-17"><a href="data.html#cb15-17" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))</span>
<span id="cb15-18"><a href="data.html#cb15-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;J-M to A-J&quot;</span>, <span class="st">&quot;A-J to J-S&quot;</span>, <span class="st">&quot;J-S to O-D&quot;</span>, <span class="st">&quot;O-D to J-M&quot;</span>),</span>
<span id="cb15-19"><a href="data.html#cb15-19" tabindex="-1"></a>     <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb15-20"><a href="data.html#cb15-20" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;late</span><span class="sc">\n</span><span class="st">winter&quot;</span>, <span class="st">&quot;breeding&quot;</span>, </span>
<span id="cb15-21"><a href="data.html#cb15-21" tabindex="-1"></a>                         <span class="st">&quot;late</span><span class="sc">\n</span><span class="st">summer&quot;</span>, <span class="st">&quot;early</span><span class="sc">\n</span><span class="st">winter&quot;</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>))</span>
<span id="cb15-22"><a href="data.html#cb15-22" tabindex="-1"></a><span class="co"># adult females</span></span>
<span id="cb15-23"><a href="data.html#cb15-23" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">1</span>,<span class="dv">2</span>,], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)),</span>
<span id="cb15-24"><a href="data.html#cb15-24" tabindex="-1"></a>         <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">1</span>,<span class="dv">2</span>,], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)), <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-25"><a href="data.html#cb15-25" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">1</span>,<span class="dv">2</span>,], <span class="dv">2</span>, mean)), <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)         </span>
<span id="cb15-26"><a href="data.html#cb15-26" tabindex="-1"></a></span>
<span id="cb15-27"><a href="data.html#cb15-27" tabindex="-1"></a><span class="co"># adult males</span></span>
<span id="cb15-28"><a href="data.html#cb15-28" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">+</span><span class="fl">0.2</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">2</span>,<span class="dv">2</span>,], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)),</span>
<span id="cb15-29"><a href="data.html#cb15-29" tabindex="-1"></a>         <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">+</span><span class="fl">0.2</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">2</span>,<span class="dv">2</span>,], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-30"><a href="data.html#cb15-30" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">+</span><span class="fl">0.2</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">2</span>,<span class="dv">2</span>,], <span class="dv">2</span>, mean)), <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)         </span>
<span id="cb15-31"><a href="data.html#cb15-31" tabindex="-1"></a></span>
<span id="cb15-32"><a href="data.html#cb15-32" tabindex="-1"></a><span class="co"># juvenile females</span></span>
<span id="cb15-33"><a href="data.html#cb15-33" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">-</span><span class="fl">0.3</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)),</span>
<span id="cb15-34"><a href="data.html#cb15-34" tabindex="-1"></a>         <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">-</span><span class="fl">0.3</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)), <span class="at">col=</span><span class="st">&quot;yellow4&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-35"><a href="data.html#cb15-35" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">-</span><span class="fl">0.3</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, mean)), <span class="at">pch=</span><span class="dv">22</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">col=</span><span class="st">&quot;yellow4&quot;</span>)         </span>
<span id="cb15-36"><a href="data.html#cb15-36" tabindex="-1"></a></span>
<span id="cb15-37"><a href="data.html#cb15-37" tabindex="-1"></a><span class="co"># juvenile males</span></span>
<span id="cb15-38"><a href="data.html#cb15-38" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)),</span>
<span id="cb15-39"><a href="data.html#cb15-39" tabindex="-1"></a>         <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)), <span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-40"><a href="data.html#cb15-40" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">plogis</span>(<span class="fu">apply</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">2</span>, mean)), <span class="at">pch=</span><span class="dv">22</span>, <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>)         </span>
<span id="cb15-41"><a href="data.html#cb15-41" tabindex="-1"></a></span>
<span id="cb15-42"><a href="data.html#cb15-42" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">3.1</span>, <span class="fl">0.6</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;yellow4&quot;</span>, <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb15-43"><a href="data.html#cb15-43" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">21</span>), <span class="at">bg=</span><span class="st">&quot;white&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;juvenile females&quot;</span>, <span class="st">&quot;juvenile males&quot;</span>, <span class="st">&quot;adult female&quot;</span>, <span class="st">&quot;adult male&quot;</span>),</span>
<span id="cb15-44"><a href="data.html#cb15-44" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:survest"></span>
<img src="predictive_model_files/figure-html/survest-1.png" alt="Three-months apparent survival estimates for juvenile (first half year) and adult Snowfinches in the Swiss Alps. Vertical bars are 95% intervals of the posterior distributions." width="672" />
<p class="caption">
Figure 2.5: Three-months apparent survival estimates for juvenile (first half year) and adult Snowfinches in the Swiss Alps. Vertical bars are 95% intervals of the posterior distributions.
</p>
</div>
<p>The preliminary results indicate that adult apparent survival is lowest in late winter and may be lower in females compared to males in late summer. Apparent survival of the freshly fledged birds in late summer may be underestimated because we assume that during the second half of their first year, their apparent survival equals adult apparent survival, which may not be true. However, after the post-juvenile moult in late summer, first year and older birds are no longer distinguisable. Therefore, of birds captured for the first time in winter, we only know that they are at least half a year old. To be able to estimate separate first year apparent survival for the whole first year, we would need to deal with unidentified ages.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data.html#cb16-1" tabindex="-1"></a><span class="co"># annual survival</span></span>
<span id="cb16-2"><a href="data.html#cb16-2" tabindex="-1"></a>annSad <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,,<span class="dv">2</span>,]), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), prod)</span>
<span id="cb16-3"><a href="data.html#cb16-3" tabindex="-1"></a>Sadwinter <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,,<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)]), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), prod)</span>
<span id="cb16-4"><a href="data.html#cb16-4" tabindex="-1"></a>Sadsummer <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,,<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), prod)</span>
<span id="cb16-5"><a href="data.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="data.html#cb16-6" tabindex="-1"></a><span class="co"># first year survival (first year survival during breeding may not be estimable, use adult survival instead):</span></span>
<span id="cb16-7"><a href="data.html#cb16-7" tabindex="-1"></a>annSfirst <span class="ot">&lt;-</span> <span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,,<span class="dv">1</span>,<span class="dv">3</span>])<span class="sc">*</span><span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0)[,,<span class="dv">2</span>,<span class="dv">4</span>]<span class="sc">*</span><span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0)[,,<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0)[,,<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb16-8"><a href="data.html#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="data.html#cb16-9" tabindex="-1"></a>Sfirstwinter <span class="ot">&lt;-</span> Sadwinter </span>
<span id="cb16-10"><a href="data.html#cb16-10" tabindex="-1"></a>Sfirstsummer <span class="ot">&lt;-</span> <span class="fu">plogis</span>(mod1<span class="sc">$</span>sims.list<span class="sc">$</span>b0[,,<span class="dv">1</span>,<span class="dv">3</span>])</span></code></pre></div>
<p>From our preliminary model, we get an annual apparent survival estimate for adult females of 0.45 (95% CrI: 0.39 - 0.51), for adult males 0.54 (0.51 - 0.57), and of first year females 0.14 (0.06 - 0.29), and for first year males 0.09 (0.04 - 0.16).</p>
<table>
<caption>Half-year apparent survival estimates (preliminary results). Note, winter apparent survival of first years is assumed to be equal to adult apparent survival.</caption>
<colgroup>
<col width="22%" />
<col width="22%" />
<col width="27%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Age</th>
<th align="right">Sex</th>
<th align="right">Apparent survival May - Nov</th>
<th align="right">Apparent survival Nov - May</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">first year</td>
<td align="right">female</td>
<td align="right">0.24 (0.1 - 0.46)</td>
<td align="right">0.71 (0.57 - 0.88)</td>
</tr>
<tr class="even">
<td align="left">first year</td>
<td align="right">male</td>
<td align="right">0.15 (0.07 - 0.26)</td>
<td align="right">0.72 (0.65 - 0.79)</td>
</tr>
<tr class="odd">
<td align="left">adult</td>
<td align="right">female</td>
<td align="right">0.63 (0.5 - 0.79)</td>
<td align="right">0.71 (0.57 - 0.88)</td>
</tr>
<tr class="even">
<td align="left">adult</td>
<td align="right">male</td>
<td align="right">0.75 (0.68 - 0.83)</td>
<td align="right">0.72 (0.65 - 0.79)</td>
</tr>
</tbody>
</table>
</div>
<div id="survival-function-of-the-predictive-population-model" class="section level4 hasAnchor" number="2.2.3.3">
<h4><span class="header-section-number">2.2.3.3</span> Survival function of the predictive population model<a href="data.html#survival-function-of-the-predictive-population-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>From the survival analyses that are available up to now, we collated a survival function that produces a survival probability for summer and winter for each age and sex class dependent on a standardised environmental variable (Fig. <a href="data.html#fig:survivalfunctions">2.6</a>). Intercepts are taken from the analyses of our own data (presented above) and effect of the environmental variables are taken from the long-term data from Austria <span class="citation">(<a href="#ref-zauner_apparent_2022">Zauner 2022</a>)</span>. For every run of the population model, we draw a random intercept and slope for each age and sex class and we keep that values for the whole population trajectory. In this way, the uncertainty of survival propagates into the uncertainty of the population trajectory.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data.html#cb17-1" tabindex="-1"></a><span class="co"># increase estimated apparent survival of first year by 10% to account for dispersal/transients</span></span>
<span id="cb17-2"><a href="data.html#cb17-2" tabindex="-1"></a>dispfactor <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb17-3"><a href="data.html#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="data.html#cb17-4" tabindex="-1"></a><span class="co"># survival from Mai to November</span></span>
<span id="cb17-5"><a href="data.html#cb17-5" tabindex="-1"></a>Ssummervalues <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Sfirstsummer<span class="sc">*</span>dispfactor, Sadsummer) <span class="co"># fy F, fy M, ad F, ad M</span></span>
<span id="cb17-6"><a href="data.html#cb17-6" tabindex="-1"></a>Ssummervalues[Ssummervalues<span class="sc">&gt;</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-7"><a href="data.html#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="data.html#cb17-8" tabindex="-1"></a>Ssummer <span class="ot">&lt;-</span> <span class="cf">function</span>(age, sex, <span class="at">env=</span><span class="dv">0</span>, <span class="at">b=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.95</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.28</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">sprob=</span>sprobsummer){</span>
<span id="cb17-9"><a href="data.html#cb17-9" tabindex="-1"></a>  agefac <span class="ot">&lt;-</span> <span class="fu">factor</span>(age, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;fy&quot;</span>, <span class="st">&quot;ad&quot;</span>))</span>
<span id="cb17-10"><a href="data.html#cb17-10" tabindex="-1"></a>  sexfac <span class="ot">&lt;-</span> <span class="fu">factor</span>(sex, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))</span>
<span id="cb17-11"><a href="data.html#cb17-11" tabindex="-1"></a>  index <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(agefac)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">as.numeric</span>(sexfac)</span>
<span id="cb17-12"><a href="data.html#cb17-12" tabindex="-1"></a>  sprobv <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">qlogis</span>(sprob[index]) <span class="sc">+</span> b[index]<span class="sc">*</span>env)</span>
<span id="cb17-13"><a href="data.html#cb17-13" tabindex="-1"></a>  alive <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(sex), <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span>sprobv)</span>
<span id="cb17-14"><a href="data.html#cb17-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sprob=</span>sprobv, <span class="at">alive=</span>alive))</span>
<span id="cb17-15"><a href="data.html#cb17-15" tabindex="-1"></a>} </span>
<span id="cb17-16"><a href="data.html#cb17-16" tabindex="-1"></a></span>
<span id="cb17-17"><a href="data.html#cb17-17" tabindex="-1"></a>Swintervalues <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Sfirstwinter<span class="sc">*</span>dispfactor, Sadwinter) <span class="co"># fy F, fy M, ad F, ad M</span></span>
<span id="cb17-18"><a href="data.html#cb17-18" tabindex="-1"></a>Swintervalues[Swintervalues<span class="sc">&gt;</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-19"><a href="data.html#cb17-19" tabindex="-1"></a></span>
<span id="cb17-20"><a href="data.html#cb17-20" tabindex="-1"></a>Swinter <span class="ot">&lt;-</span> <span class="cf">function</span>(age, sex, <span class="at">env=</span><span class="dv">0</span>, <span class="at">b=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.95</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.28</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">sprob=</span>sprobwinter){</span>
<span id="cb17-21"><a href="data.html#cb17-21" tabindex="-1"></a>  agefac <span class="ot">&lt;-</span> <span class="fu">factor</span>(age, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;fy&quot;</span>, <span class="st">&quot;ad&quot;</span>))</span>
<span id="cb17-22"><a href="data.html#cb17-22" tabindex="-1"></a>  sexfac <span class="ot">&lt;-</span> <span class="fu">factor</span>(sex, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))</span>
<span id="cb17-23"><a href="data.html#cb17-23" tabindex="-1"></a>  index <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(agefac)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">as.numeric</span>(sexfac)</span>
<span id="cb17-24"><a href="data.html#cb17-24" tabindex="-1"></a>  sprobv <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">qlogis</span>(sprob[index]) <span class="sc">+</span> b[index]<span class="sc">*</span>env)</span>
<span id="cb17-25"><a href="data.html#cb17-25" tabindex="-1"></a>  alive <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(sex), <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span>sprobv)</span>
<span id="cb17-26"><a href="data.html#cb17-26" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sprob=</span>sprobv, <span class="at">alive=</span>alive))</span>
<span id="cb17-27"><a href="data.html#cb17-27" tabindex="-1"></a>} </span>
<span id="cb17-28"><a href="data.html#cb17-28" tabindex="-1"></a></span>
<span id="cb17-29"><a href="data.html#cb17-29" tabindex="-1"></a></span>
<span id="cb17-30"><a href="data.html#cb17-30" tabindex="-1"></a>envx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb17-31"><a href="data.html#cb17-31" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sex=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>), <span class="at">age=</span><span class="fu">c</span>(<span class="st">&quot;fy&quot;</span>, <span class="st">&quot;ad&quot;</span>), <span class="at">env=</span>envx)</span>
<span id="cb17-32"><a href="data.html#cb17-32" tabindex="-1"></a>fitmatsu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol=</span><span class="fu">nrow</span>(Ssummervalues), <span class="at">nrow=</span><span class="fu">nrow</span>(newdat))</span>
<span id="cb17-33"><a href="data.html#cb17-33" tabindex="-1"></a>fitmatwi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol=</span><span class="fu">nrow</span>(Ssummervalues), <span class="at">nrow=</span><span class="fu">nrow</span>(newdat))</span>
<span id="cb17-34"><a href="data.html#cb17-34" tabindex="-1"></a><span class="co"># According to Aichhorn temp-effect: adult F -0.95, M -0.28</span></span>
<span id="cb17-35"><a href="data.html#cb17-35" tabindex="-1"></a></span>
<span id="cb17-36"><a href="data.html#cb17-36" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Ssummervalues)){</span>
<span id="cb17-37"><a href="data.html#cb17-37" tabindex="-1"></a>  benvsu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.95</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.28</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">sd=</span><span class="fu">c</span>(<span class="fl">0.3</span><span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.3</span><span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.21</span><span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.42</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb17-38"><a href="data.html#cb17-38" tabindex="-1"></a>  benvwi <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.95</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">0.28</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">sd=</span><span class="fu">c</span>(<span class="fl">0.3</span><span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.3</span><span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.21</span><span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.42</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb17-39"><a href="data.html#cb17-39" tabindex="-1"></a>  fitmatsu[,i] <span class="ot">&lt;-</span> <span class="fu">Ssummer</span>(<span class="at">age=</span>newdat<span class="sc">$</span>age, <span class="at">sex=</span>newdat<span class="sc">$</span>sex, <span class="at">env=</span>newdat<span class="sc">$</span>env, <span class="at">b=</span>benvsu, <span class="at">sprob=</span>Ssummervalues[i,])<span class="sc">$</span>sprob</span>
<span id="cb17-40"><a href="data.html#cb17-40" tabindex="-1"></a>  fitmatwi[,i] <span class="ot">&lt;-</span> <span class="fu">Swinter</span>(<span class="at">age=</span>newdat<span class="sc">$</span>age, <span class="at">sex=</span>newdat<span class="sc">$</span>sex, <span class="at">env=</span>newdat<span class="sc">$</span>env, <span class="at">b=</span>benvwi, <span class="at">sprob=</span>Swintervalues[i,])<span class="sc">$</span>sprob</span>
<span id="cb17-41"><a href="data.html#cb17-41" tabindex="-1"></a>}</span>
<span id="cb17-42"><a href="data.html#cb17-42" tabindex="-1"></a></span>
<span id="cb17-43"><a href="data.html#cb17-43" tabindex="-1"></a>newdat<span class="sc">$</span>Ssummer.fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatsu, <span class="dv">1</span>, median)</span>
<span id="cb17-44"><a href="data.html#cb17-44" tabindex="-1"></a>newdat<span class="sc">$</span>Ssummer.lwr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatsu, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb17-45"><a href="data.html#cb17-45" tabindex="-1"></a>newdat<span class="sc">$</span>Ssummer.upr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatsu, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb17-46"><a href="data.html#cb17-46" tabindex="-1"></a></span>
<span id="cb17-47"><a href="data.html#cb17-47" tabindex="-1"></a>newdat<span class="sc">$</span>Swinter.fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatwi, <span class="dv">1</span>, median)</span>
<span id="cb17-48"><a href="data.html#cb17-48" tabindex="-1"></a>newdat<span class="sc">$</span>Swinter.lwr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatwi, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb17-49"><a href="data.html#cb17-49" tabindex="-1"></a>newdat<span class="sc">$</span>Swinter.upr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatwi, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb17-50"><a href="data.html#cb17-50" tabindex="-1"></a></span>
<span id="cb17-51"><a href="data.html#cb17-51" tabindex="-1"></a>newdat<span class="sc">$</span>S.fit <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatsu<span class="sc">*</span>fitmatwi, <span class="dv">1</span>, median)</span>
<span id="cb17-52"><a href="data.html#cb17-52" tabindex="-1"></a>newdat<span class="sc">$</span>S.lwr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatsu<span class="sc">*</span>fitmatwi, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb17-53"><a href="data.html#cb17-53" tabindex="-1"></a>newdat<span class="sc">$</span>S.upr <span class="ot">&lt;-</span> <span class="fu">apply</span>(fitmatsu<span class="sc">*</span>fitmatwi, <span class="dv">1</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb17-54"><a href="data.html#cb17-54" tabindex="-1"></a></span>
<span id="cb17-55"><a href="data.html#cb17-55" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb17-56"><a href="data.html#cb17-56" tabindex="-1"></a><span class="fu">plot</span>(newdat<span class="sc">$</span>env, newdat<span class="sc">$</span>Ssummer.fit, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Environmental variable&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&quot;Summer survival&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb17-57"><a href="data.html#cb17-57" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;fy&quot;</span></span>
<span id="cb17-58"><a href="data.html#cb17-58" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-59"><a href="data.html#cb17-59" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Ssummer.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Ssummer.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-60"><a href="data.html#cb17-60" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Ssummer.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-61"><a href="data.html#cb17-61" tabindex="-1"></a></span>
<span id="cb17-62"><a href="data.html#cb17-62" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;fy&quot;</span></span>
<span id="cb17-63"><a href="data.html#cb17-63" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-64"><a href="data.html#cb17-64" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Ssummer.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Ssummer.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-65"><a href="data.html#cb17-65" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Ssummer.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-66"><a href="data.html#cb17-66" tabindex="-1"></a></span>
<span id="cb17-67"><a href="data.html#cb17-67" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;ad&quot;</span></span>
<span id="cb17-68"><a href="data.html#cb17-68" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-69"><a href="data.html#cb17-69" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Ssummer.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Ssummer.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-70"><a href="data.html#cb17-70" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Ssummer.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-71"><a href="data.html#cb17-71" tabindex="-1"></a></span>
<span id="cb17-72"><a href="data.html#cb17-72" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;ad&quot;</span></span>
<span id="cb17-73"><a href="data.html#cb17-73" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-74"><a href="data.html#cb17-74" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Ssummer.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Ssummer.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-75"><a href="data.html#cb17-75" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Ssummer.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-76"><a href="data.html#cb17-76" tabindex="-1"></a></span>
<span id="cb17-77"><a href="data.html#cb17-77" tabindex="-1"></a><span class="co"># winter survival</span></span>
<span id="cb17-78"><a href="data.html#cb17-78" tabindex="-1"></a><span class="fu">plot</span>(newdat<span class="sc">$</span>env, newdat<span class="sc">$</span>S.fit, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Environmental variable&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&quot;Winter survival&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb17-79"><a href="data.html#cb17-79" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;fy&quot;</span></span>
<span id="cb17-80"><a href="data.html#cb17-80" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-81"><a href="data.html#cb17-81" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Swinter.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Swinter.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-82"><a href="data.html#cb17-82" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Swinter.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-83"><a href="data.html#cb17-83" tabindex="-1"></a></span>
<span id="cb17-84"><a href="data.html#cb17-84" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;fy&quot;</span></span>
<span id="cb17-85"><a href="data.html#cb17-85" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-86"><a href="data.html#cb17-86" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Swinter.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Swinter.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-87"><a href="data.html#cb17-87" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Swinter.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-88"><a href="data.html#cb17-88" tabindex="-1"></a></span>
<span id="cb17-89"><a href="data.html#cb17-89" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;ad&quot;</span></span>
<span id="cb17-90"><a href="data.html#cb17-90" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-91"><a href="data.html#cb17-91" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Swinter.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Swinter.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-92"><a href="data.html#cb17-92" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Swinter.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-93"><a href="data.html#cb17-93" tabindex="-1"></a></span>
<span id="cb17-94"><a href="data.html#cb17-94" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;ad&quot;</span></span>
<span id="cb17-95"><a href="data.html#cb17-95" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-96"><a href="data.html#cb17-96" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>Swinter.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>Swinter.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-97"><a href="data.html#cb17-97" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>Swinter.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-98"><a href="data.html#cb17-98" tabindex="-1"></a></span>
<span id="cb17-99"><a href="data.html#cb17-99" tabindex="-1"></a><span class="co"># annual</span></span>
<span id="cb17-100"><a href="data.html#cb17-100" tabindex="-1"></a><span class="fu">plot</span>(newdat<span class="sc">$</span>env, newdat<span class="sc">$</span>S.fit, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Environmental variable&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&quot;Annual survival&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb17-101"><a href="data.html#cb17-101" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;fy&quot;</span></span>
<span id="cb17-102"><a href="data.html#cb17-102" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-103"><a href="data.html#cb17-103" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>S.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>S.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-104"><a href="data.html#cb17-104" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>S.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-105"><a href="data.html#cb17-105" tabindex="-1"></a></span>
<span id="cb17-106"><a href="data.html#cb17-106" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;fy&quot;</span></span>
<span id="cb17-107"><a href="data.html#cb17-107" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-108"><a href="data.html#cb17-108" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>S.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>S.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-109"><a href="data.html#cb17-109" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>S.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-110"><a href="data.html#cb17-110" tabindex="-1"></a></span>
<span id="cb17-111"><a href="data.html#cb17-111" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;ad&quot;</span></span>
<span id="cb17-112"><a href="data.html#cb17-112" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-113"><a href="data.html#cb17-113" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>S.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>S.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-114"><a href="data.html#cb17-114" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>S.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-115"><a href="data.html#cb17-115" tabindex="-1"></a></span>
<span id="cb17-116"><a href="data.html#cb17-116" tabindex="-1"></a>index <span class="ot">&lt;-</span> newdat<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span> <span class="sc">&amp;</span> newdat<span class="sc">$</span>age<span class="sc">==</span><span class="st">&quot;ad&quot;</span></span>
<span id="cb17-117"><a href="data.html#cb17-117" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(newdat<span class="sc">$</span>env[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>env[index])),</span>
<span id="cb17-118"><a href="data.html#cb17-118" tabindex="-1"></a>        <span class="fu">c</span>(newdat<span class="sc">$</span>S.lwr[index], <span class="fu">rev</span>(newdat<span class="sc">$</span>S.upr[index])), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-119"><a href="data.html#cb17-119" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>env[index], newdat<span class="sc">$</span>S.fit[index], <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-120"><a href="data.html#cb17-120" tabindex="-1"></a></span>
<span id="cb17-121"><a href="data.html#cb17-121" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">0.7</span>,<span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;First year female&quot;</span>, <span class="st">&quot;First year male&quot;</span>, <span class="st">&quot;Adult female&quot;</span>, <span class="st">&quot;Adult male&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb17-122"><a href="data.html#cb17-122" tabindex="-1"></a></span>
<span id="cb17-123"><a href="data.html#cb17-123" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Survival probability&quot;</span>, <span class="at">side=</span><span class="dv">2</span>, <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:survivalfunctions"></span>
<img src="predictive_model_files/figure-html/survivalfunctions-1.png" alt="Survival function used in the predictive population model." width="672" />
<p class="caption">
Figure 2.6: Survival function used in the predictive population model.
</p>
</div>
</div>
</div>
</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Aichhorn.1966" class="csl-entry">
Aichhorn, A. 1966. <span>âBrutbiologie Und Verhalten Des Schneefinken in Tirol.â</span> <em>Journal of Ornithology</em> 107: 398.
</div>
<div id="ref-grange_biologie_2008" class="csl-entry">
GrangÃ©, J.-L. 2008. <span>âBiologie de Reproduction de La Niverolle Alpine Montifringilla Nivalis Dans Les PyrÃ©nÃ©es Occidentales FranÃ§aises.â</span> <em>Nos Oiseaux</em> 55: 67â82.
</div>
<div id="ref-Ijjas.2022" class="csl-entry">
Ijjas, Fanni. 2022. <span>âNestlingswachstum Der Schneesperlinge in AbhÃ¤ngigkeit Der Nestlingsanzahl, Schneeschmelze Und Nahrung; MÃ¶gliche Auswirkungen Des Klimawandels.â</span> PhD thesis, Wien: University of Natural Resources; Life Sciences, Vienna.
</div>
<div id="ref-laake_hidden_2014" class="csl-entry">
Laake, Jeffrey L., Devin S. Johnson, Duane R. Diefenbach, and Mark A. Ternent. 2014. <span>âHidden Markov Model for Dependent Mark Loss and Survival Estimation.â</span> <em>Journal of Agricultural, Biological, and Environmental Statistics</em> 19 (4): 524â40. <a href="https://doi.org/10.1007/s13253-014-0190-1">https://doi.org/10.1007/s13253-014-0190-1</a>.
</div>
<div id="ref-Plummer2003" class="csl-entry">
Plummer, Martyn. 2003. <span>â<span>JAGS</span> : A Program for Analysis of Bayesian Graphical Models Using Gibbs Sampling <span>JAGS</span> : Just Another Gibbs Sampler.â</span> In <em>Proceedings of the 3rd International Workshop on Distributed Statistical Computing</em>, edited by K. Hornik, F. Leisch, and A. Zeileis, 1â8. Vienna.
</div>
<div id="ref-Pradel.1997" class="csl-entry">
Pradel, R, J E Hines, J D Lebreton, and J D Nichols. 1997. <span>âEstimating Survival Rate and Proportion of Transients Using Capture-Recapture Data from Open Population.â</span> <em>Biometrics</em> 53: 88â99.
</div>
<div id="ref-pradel_multievent_2005" class="csl-entry">
Pradel, Roger. 2005. <span>âMultievent: An Extension of Multistate CaptureâRecapture Models to Uncertain States.â</span> <em>Biometrics</em> 61 (2): 442â47. <a href="https://doi.org/10.1111/j.1541-0420.2005.00318.x">https://doi.org/10.1111/j.1541-0420.2005.00318.x</a>.
</div>
<div id="ref-Schano.2021" class="csl-entry">
Schano, Christian, Carole Niffenegger, Tobias Jonas, and FrÃ¤nzi Korner-Nievergelt. 2021. <span>âHatching Phenology Is Lagging Behind an Advancing Snowmelt Pattern in a High-Alpine Bird.â</span> <em>Scientific Reports</em> 11 (1): 20130016. <a href="https://doi.org/10.1038/s41598-021-01497-8">https://doi.org/10.1038/s41598-021-01497-8</a>.
</div>
<div id="ref-Strinella.2020" class="csl-entry">
Strinella, Eliseo, Davide Scridel, Mattia Brambilla, Christian Schano, and FrÃ¤nzi Korner-Nievergelt. 2020. <span>âPotential Sex-Dependent Effects of Weather on Apparent Survival of a High-Elevation Specialist.â</span> <em>Scientific Reports</em> 10 (1): 8386. <a href="https://doi.org/10.1038/s41598-020-65017-w">https://doi.org/10.1038/s41598-020-65017-w</a>.
</div>
<div id="ref-strinella_biologia_2011" class="csl-entry">
Strinella, E., P. Vianale, S. Pirrello, and C. Artese. 2011. <span>âBiologia Riproduttiva Del Fringuella Alpino Montifringilla Nivalis a Campo Imeratore Nel Parco Nazionale de Gran Sasso e Monti Della Laga (<span>AQ</span>).â</span> <em>Aula</em> 8: 95â100.
</div>
<div id="ref-zauner_apparent_2022" class="csl-entry">
Zauner, Severin. 2022. <span>âApparent Survival and Spatial Movement of Snowfinches (Montfringilla Nivalis) in Austria.â</span> PhD thesis, University of Natural Resources; Life Sciences, Vienna.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="population-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
